

 {% extends 'shop/base.html' %}



    
{% block title %} {{ pc }} | Category | Page {% endblock %}

   
{% load static %}

{% load custom_tags %}




{% block body %}



    
    <div class="breadcrumbs">
        <a href="{% url 'shop:index' %}">Home</a>
        <span>/</span>
        <a href="{% url 'shop:index' %}">Shop</a>
        <span>/</span>
        <a href="{% url 'shop:categories' %}">Categories</a>
        <!-- <span>/</span>
        <span>Running Shoes</span> -->
    </div>
    
    <div class="category-container">
        <div class="category-header">
            <h1 class="category-title">{{ pc.name }}</h1>
            <p class="category-description">
               {{ pc.description }} 
            </p>
        </div>
        
        <div class="category-actions">
            <div class="category-filters">
                <div class="filter-group">
                    <button class="filter-btn" onclick="toggleFilter('category-filter')">
                        <span>Category</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="filter-dropdown" id="category-filter">

                       

                        {% for category in categories %}

                        <div class="filter-option">
                            <label>
                                <input type="checkbox" class="category" value="{{ category.name }}" {% if category.name == pc %}checked {% endif %}>
                                {{ category.name }}
                            </label>
                        </div>

                        {% endfor %}


                  


                 


                    </div>
                </div>
                
                <div class="filter-group">
                    <button class="filter-btn" onclick="toggleFilter('brand-filter')">
                        <span>Brand</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="filter-dropdown" id="brand-filter">


                        {% for brand in brands %}


                        <div class="filter-option">

                                <label>
                                <input type="checkbox" value="{{ brand.name }}" class="brand">
                                {{ brand.name }}
                            </label>
                        </div>


                        {% endfor %}



                  



                      




                    </div>
                </div>
                
                <div class="filter-group">
                    <button class="filter-btn" onclick="toggleFilter('size-filter')">
                        <span>Size</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="filter-dropdown" id="size-filter">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem;">
                            

                            {% for size in sizes %}
                            
                            <label class="filter-option">
                                <input type="checkbox" class="size" value="{{ size.name }}">
                                {{ size.name }}
                            </label>

                            {% endfor %}


                           


                   



                        </div>
                    </div>
                </div>
                
                <div class="filter-group">
                    <button class="filter-btn" onclick="toggleFilter('color-filter')">
                        <span>Color</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="filter-dropdown" id="color-filter">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem;">
                            

                            {% for color in colors %}
                            
                            
                            <label class="filter-option">
                                <input type="checkbox" class="color" value="{{ color.name }}">
                                {{ color.name }}
                            </label>

                           
                            {% endfor %}




                        </div>
                    </div>
                </div>
            </div>
            
            <div class="sort-options">
                <span class="sort-label">Sort by:</span>
                <select class="sort-select" id="sort-select">
                    <option value="new">Newest Arrivals</option>
                    <option value="low">Price: Low to High</option>
                    <option value="high">Price: High to Low</option>
                    
                    <option value="rated">Best Rated</option>
                </select>
            </div>
        </div>
        
        <div class="category-grid">
            <div class="sidebar">
                
                
                <div class="sidebar-section">
                    <h3 class="sidebar-title">Gender</h3>
                    <div class="filter-option">
                        <label>
                            <input type="checkbox" checked>
                            Men
                        </label>
                    </div>
                    <div class="filter-option">
                        <label>
                            <input type="checkbox" checked>
                            Women
                        </label>
                    </div>
                    <div class="filter-option">
                        <label>
                            <input type="checkbox">
                            Unisex
                        </label>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3 class="sidebar-title">Features</h3>
                    <div class="filter-option">
                        <label>
                            <input type="checkbox">
                            Cushioned
                        </label>
                    </div>
                    <div class="filter-option">
                        <label>
                            <input type="checkbox">
                            Lightweight
                        </label>
                    </div>
                    <div class="filter-option">
                        <label>
                            <input type="checkbox">
                            Waterproof
                        </label>
                    </div>
                    <div class="filter-option">
                        <label>
                            <input type="checkbox">
                            Breathable
                        </label>
                    </div>
                    <div class="filter-option">
                        <label>
                            <input type="checkbox">
                            Arch Support
                        </label>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3 class="sidebar-title">Discount</h3>
                    <div class="filter-option">
                        <label>
                            <input type="checkbox">
                            On Sale
                        </label>
                    </div>
                    <div class="filter-option">
                        <label>
                            <input type="checkbox">
                            Clearance
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="category-products">

                 
                {% for product in products %}

                <a href="{% url 'shop:productDetail' slug=product.slug %}">

                <!-- Product 1 -->
                <div class="product-card">
                    <div class="product-img-container">

                        {% for image in product.images.all|slice:":1" %}

                        <img src="{{ image.image.url }}" alt="Ultra Boost Running Shoes" class="product-img">
                         <!-- <div class="product-badge">Sale</div> -->

                         {% endfor %}


                    </div>
                    <div class="product-info">
                        <div class="product-brand">{{ product.brand }}</div>
                        <h3 class="product-title">{{ product.name }}</h3>
                        <div class="product-price">
                            <span class="current-price">${{ product.price }} </span>
                            <!-- <span class="original-price">$179.99</span> -->
                        </div>
                        <div class="product-rating">
                           
                            <div class="rating-stars">

                               

                                


                               
                 {% if product.rating %}

                   {% for _ in product.rating|times %}

                    <i class="fas fa-star"></i>


                    {% endfor %}

                    {% for _ in product.rating|rating|times %}

                    <i class="far fa-star"></i>

                    {% endfor %}

                    {% endif %}



                            </div>
                            <!-- <span class="rating-count">(142)</span> -->
                        </div>
                        <button class="btn" style="width: 100%;">Add to Cart</button>
                    </div>
                </div>

                </a>


                

                   {% endfor %}


                <!-- Product 2 -->
                
                
               
                
                
                




            </div>
        </div>
        
        <div class="pagination">

            {% if products.has_previous %}
            <button class="page-btn prev" value="{{ products.previous_page_number }}"><i class="fas fa-chevron-left"></i></button>
            
            <button class="page-btn prev" value="{{ products.previous_page_number }}"> {{ products.previous_page_number }} </button>


            {% endif %} 

            <button class="page-btn active">{{ products.number }}</button>
            <br>


            {% if products.has_next %}
            <button class="page-btn next" onclick="prevs()" value="{{ products.next_page_number }}">{{ products.next_page_number }}</button>
            
            <button class="page-btn next" value="{{ products.next_page_number }}"><i class="fas fa-chevron-right"></i></button>
            {% endif %}

        </div>
    </div>
    
    
    <script>
        // Toggle filter dropdowns
        function toggleFilter(id) {
            const filter = document.getElementById(id);
            const group = filter.parentElement;
            group.classList.toggle('active');
            
            // Close other open filters
            document.querySelectorAll('.filter-group').forEach(fg => {
                if (fg !== group && fg.classList.contains('active')) {
                    fg.classList.remove('active');
                }
            });
        }
        
        // Close filters when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.filter-group')) {
                document.querySelectorAll('.filter-group').forEach(fg => {
                    fg.classList.remove('active');
                });
            }
        });
        
        





let sizes = [];
let colors = [];

let brands = [];

let categories = [];

let selected;
let page = 1;

$('document').ready(function() {   


    function selectfn(){
     
       selected = $("#sort-select").val();


    }



function brandsfn(){

$(".brand:checked").each(function(){
    brands.push($(this).val());

});

}

function sizesfn(){

    $(".size:checked").each(function(){
    sizes.push($(this).val());


});

}

function colorsfn(){

$(".color:checked").each(function(){
        colors.push($(this).val());
    });




}

function categoryfn(){

  
     $(".category:checked").each(function(){
    categories.push($(this).val());


});

    

}


function req(){

    $(".category-products").html("content is loading......");


$.ajax({
    url: "{% url 'shop:category' slug=pc %}",
    type: "POST",
    data: {
        'brands': brands,
        'sizes': sizes,
        'colors': colors,
        'categories': categories,
        'selected': selected,
        'page': page,
        
        'csrfmiddlewaretoken': '{{ csrf_token }}'
    },
    success: function(res) {

        $(".category-products").html(res.html);
        $(".pagination").html(res.realPaginator);


        
      
    },
    error: function(xhr, status, error) {
        console.error("Error filtering products:", error);
    }

});


}






$(".sort-select").change(function(){


brandsfn();
colorsfn();
sizesfn();
selectfn();
categoryfn();
req();

brands = [];
sizes = [];
colors = [];
categories = [];




});


$(".category").change(function(){


brandsfn();
colorsfn();
sizesfn();
selectfn();
categoryfn();
req();

brands = [];
sizes = [];
colors = [];
categories = [];




});



$(".brand").change(function(){


brandsfn();
colorsfn();
sizesfn();
selectfn();
categoryfn();
req();

brands = [];
sizes = [];
colors = [];
categories = [];




});


$(".size").change(function(){



brandsfn();
colorsfn();
sizesfn();
selectfn();
categoryfn();
req();

brands = [];
sizes = [];
colors = [];
categories = [];


});



$(".color").change(function(){

   
brandsfn();
colorsfn();
sizesfn();
selectfn();
categoryfn();
req();

brands = [];
sizes = [];
colors = []; 
categories = [];

    
});




$(document).on('click','.prev',function(){


    


page = $(this).val();

brandsfn();
colorsfn();
sizesfn();
selectfn();
categoryfn();
req();

brands = [];
sizes = [];
colors = []; 
categories = [];





});





$(document).on('click','.next',function(){



page = $(this).val();

brandsfn();
colorsfn();
sizesfn();
selectfn();
categoryfn();
req();

brands = [];
sizes = [];
colors = []; 
categories = [];





});





});












    </script>

{% endblock %}